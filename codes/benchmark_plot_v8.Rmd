---
title: "benchmark_plot"
author: "Yunwei Zhang"
date: “`r paste0('Initiated on 2020 Nov 26th, compiled on ', format(Sys.time(), '%Y %b %d'))`”
output:
  
  html_document:
    code_folding: hide
    fig_height: 8
    fig_width: 12
    highlight: tango
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: yes
      smooth_scroll: no
  pdf_document:
    toc: yes
    toc_depth: '4'
    number_sections: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning = FALSE,message = FALSE)
```

```{r}
library(dplyr)
library(ggplot2)
library(pheatmap)
library(RColorBrewer)
library(reshape2)
library(ggpubr)
library(ComplexHeatmap)
library(circlize)
library(readxl)
library(plyr)
library(knitr)
library(stargazer)
setwd("~/Dropbox (Sydney Uni)/YunweiZhang/WeeklyProgress/R code/benchmarking/202012summaryresult")
```

* this moved from 202011fromserverold2, this is the new summary report to generate plots
(* this is the new summarised plot for picked methods (based on benchmark_plot5,6,7))


# data {.tabset .tabset-fade .tabset-pills}


```{r}
plot_fun=function(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1, coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm){
cox1dt=bind_rows(cox1, .id = "column_label")
cox1value=colMeans(cox1dt[,-1],na.rm = TRUE)
cox2dt=bind_rows(cox2, .id = "column_label")
cox2value=colMeans(cox2dt[,-1],na.rm = TRUE)
cox3dt=bind_rows(cox3, .id = "column_label")
cox3value=colMeans(cox3dt[,-1],na.rm = TRUE)
#this contains NA 
cox4=cox4[lapply(cox4,length)>1]
cox4dt=bind_rows(cox4, .id = "column_label")
cox4value=colMeans(cox4dt[,-1],na.rm = TRUE)
#cox5dt=bind_rows(cox5, .id = "column_label")
#cox5value=colMeans(cox5dt[,-1],na.rm = TRUE)
#cox6dt=bind_rows(cox6, .id = "column_label")
#cox6value=colMeans(cox6dt[,-1],na.rm = TRUE)
pcox1dt=bind_rows(pcox1, .id = "column_label")
pcox1value=colMeans(pcox1dt[,-1],na.rm = TRUE)
pcox2dt=bind_rows(pcox2, .id = "column_label")
pcox2value=colMeans(pcox2dt[,-1],na.rm = TRUE)
pcox3dt=bind_rows(pcox3, .id = "column_label")
pcox3value=colMeans(pcox3dt[,-1],na.rm = TRUE)
rsf1dt=bind_rows(rsf1, .id = "column_label")
rsf1value=colMeans(rsf1dt[,-1],na.rm = TRUE)
rsf2dt=bind_rows(rsf2, .id = "column_label")
rsf2value=colMeans(rsf2dt[,-1],na.rm = TRUE)
mtlr1dt=bind_rows(mtlr1, .id = "column_label")
mtlr1value=colMeans(mtlr1dt[,-1],na.rm = TRUE)
dnnsurv1dt=bind_rows(dnnsurv1, .id = "column_label")
dnnsurv1value=colMeans(dnnsurv1dt[,-1],na.rm = TRUE)
coxboostdt=bind_rows(coxboost, .id = "column_label")
coxboostvalue=colMeans(coxboostdt[,-1],na.rm = TRUE)
gacoxdt=bind_rows(gacox, .id = "column_label")
gacoxvalue=colMeans(gacoxdt[,-1],na.rm = TRUE)
gamtlrdt=bind_rows(gamtlr, .id = "column_label")
gamtlrvalue=colMeans(gamtlrdt[,-1],na.rm = TRUE)
gacoxboostdt=bind_rows(gacoxboost, .id = "column_label")
gacoxboostvalue=colMeans(gacoxboostdt[,-1],na.rm = TRUE)
limmamtlrdt=bind_rows(limmamtlr, .id = "column_label")
limmamtlrvalue=colMeans(limmamtlrdt[,-1],na.rm = TRUE)
limmacoxboostdt=bind_rows(limmacoxboost, .id = "column_label")
limmacoxboostvalue=colMeans(limmacoxboostdt[,-1],na.rm = TRUE)
survivalsvmdt=bind_rows(survivalsvm, .id = "column_label")
survivalsvmvalue=colMeans(survivalsvmdt[,-1],na.rm = TRUE)





nb.cols <- 18
mycolors <- colorRampPalette(brewer.pal(8, "Set2"))(nb.cols)

plotdt1=rbind.data.frame(cox1value,cox2value,cox3value,cox4value,pcox1value,pcox2value,pcox3value,rsf1value,rsf2value,mtlr1value,dnnsurv1value,coxboostvalue,gacoxvalue,gamtlrvalue,gacoxboostvalue,limmamtlrvalue,limmacoxboostvalue,survivalsvmvalue)
rownames(plotdt1)=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
colnames(plotdt1)=names(pcox1value)
head(plotdt1)
plotdt2=t(plotdt1)
#head(plotdt2)
#plotdt3=apply(plotdt2, MARGIN = 2, FUN = function(X) (X - min(X))/diff(range(X)))
plotdt3=plotdt2[-c(2,4,5:10),]
#plotdt3[plotdt3>1]=NA #out of range (0,1) is definde as NA
breaksList = seq(0.5, 1, by = 0.1)
#pheatmap(as.matrix(plotdt3),cellwidth = 15, cellheight = 15, fontsize = 8,cluster_rows = FALSE,cluster_cols = FALSE,color =colorRampPalette(c("#999999", "#E69F00", "#56B4E9"))(length(breaksList)),breaks = breaksList)
p1=pheatmap(as.matrix(plotdt3),cellwidth = 15, cellheight = 15, fontsize = 8,cluster_rows = FALSE,cluster_cols = FALSE,color =colorRampPalette(rev(brewer.pal(n = 7, name = "Pastel1")))(length(breaksList)),breaks = breaksList)
#print(p1)

# create data frame with all values
colnames(cox1dt)=colnames(cox2dt)=colnames(cox3dt)=colnames(cox4dt)=colnames(pcox1dt)=colnames(pcox2dt)=colnames(pcox3dt)=colnames(rsf1dt)=colnames(rsf2dt)=colnames(mtlr1dt)=colnames(dnnsurv1dt)=colnames(coxboostdt)=colnames(gacoxdt)=colnames(gamtlrdt)=colnames(gacoxboostdt)=colnames(limmamtlrdt)=colnames(limmacoxboostdt)=colnames(survivalsvmdt)=c("model","hc","bc","unoc","ghc","bs1","bs2","bs3","bs4","bs5","bs6","auc1","auc2","auc3","auc4","auc5","auc6","auc7","auc8","auc9","auc10","auc11","auc12","auc13","auc14","auc15","auc")
widedt=do.call("rbind", list(cox1dt,cox2dt,cox3dt,cox4dt,pcox1dt,pcox2dt,pcox3dt,rsf1dt,rsf2dt,mtlr1dt,dnnsurv1dt,coxboostdt,gacoxdt,gamtlrdt,gacoxboostdt,limmamtlrdt,limmacoxboostdt,survivalsvmdt))
widedt[,1]=c(rep("cox1",nrow(cox1dt)),rep("cox2",nrow(cox2dt)),rep("cox3",nrow(cox3dt)),rep("cox4",nrow(cox4dt)),rep("pcox1",nrow(pcox1dt)),rep("pcox2",nrow(pcox2dt)),rep("pcox3",nrow(pcox3dt)),rep("rsf1",nrow(rsf1dt)),rep("rsf2",nrow(rsf2dt)),rep("mtlr1",nrow(mtlr1dt)),rep("dnnsurv1",nrow(dnnsurv1dt)),rep("coxboost",nrow(coxboostdt)),rep("gacox",nrow(gacoxdt)),rep("gamtlr",nrow(gamtlrdt)),rep("gacoxboost",nrow(gacoxboostdt)),rep("limmamtlr",nrow(limmamtlrdt)),rep("limmacoxboost",nrow(limmacoxboostdt)),rep("survivalsvm",nrow(survivalsvmdt)))
# grouped boxplot
longdt=melt(widedt,id.vars = "model",na.rm = TRUE)
#dim(longdt)
#any(is.na(longdt))

# get the hc
plotdt=longdt[longdt$variable=="hc",]
#plotdt[plotdt$value <0.5 | plotdt$value >0.99,3] <- NA
#plotdt[plotdt$value < quantile(plotdt$value, 0.85,na.rm = T) | plotdt$value > quantile(plotdt$value, 0.15,na.rm = T), ]

plotdt$model=factor(plotdt$model,levels=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm"))
g1=ggplot(plotdt, aes(x=model, y=value, fill=model)) + geom_boxplot(lwd=0.5)+scale_fill_manual(values = mycolors,drop=FALSE) #+scale_y_continuous(limits=c(0.5,1))

# get all the cindex
plotdt=longdt[longdt$variable=="hc"|longdt$variable=="bc"|longdt$variable=="unoc"|longdt$variable=="ghc",]
plotdt$model=factor(plotdt$model,levels=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm"))
g2=ggplot(plotdt, aes(x=model, y=value, fill=variable)) + geom_boxplot(lwd=0.5)+scale_fill_manual(values = mycolors) #+scale_y_continuous(limits=c(0.5,1))

# get all the auc
plotdt=longdt[longdt$variable=="auc1"|longdt$variable=="auc2"|longdt$variable=="auc3"|longdt$variable=="auc4",]
plotdt$model=factor(plotdt$model,levels=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm"))
g3=ggplot(plotdt, aes(x=model, y=value, fill=variable)) + geom_boxplot(lwd=0.5)+scale_fill_manual(values = mycolors, drop=FALSE) #+scale_y_continuous(limits=c(0.5,1))

# get all the bs
plotdt=longdt[longdt$variable=="bs1"|longdt$variable=="bs2",]
plotdt$model=factor(plotdt$model,levels=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm"))
g4=ggplot(plotdt, aes(x=model, y=value, fill=variable)) + geom_boxplot(lwd=0.1,outlier.shape = NA)+scale_fill_manual(values = mycolors) 

# get bs1
plotdt=longdt[longdt$variable=="bs1",]
plotdt$model=factor(plotdt$model,levels=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm"))
g5=ggplot(plotdt, aes(x=model, y=value, fill=model)) + geom_boxplot(lwd=0.5,outlier.shape = NA)+scale_fill_manual(values = mycolors, drop=FALSE) 



# get auc curve
plotdt=longdt[longdt$variable=="auc1"|longdt$variable=="auc2"|longdt$variable=="auc3"|longdt$variable=="auc4"|longdt$variable=="auc5"|longdt$variable=="auc6"|longdt$variable=="auc7"|longdt$variable=="auc8"|longdt$variable=="auc9"|longdt$variable=="auc10"|longdt$variable=="auc11"|longdt$variable=="auc12"|longdt$variable=="auc13"|longdt$variable=="auc14"|longdt$variable=="auc15",]
#plotdt[plotdt$value >1 | plotdt$value==0,3] <- NA

plotdt2 <- plotdt %>%dplyr::group_by(variable,model) %>%dplyr::summarize(Mean = mean(value))
plotdt2$timepoint=as.numeric(gsub(".*?([0-9]+).*", "\\1", plotdt2$variable))
# g6=ggplot(data = plotdt2, aes(timepoint, Mean)) +
#   geom_line() +geom_smooth()+
#   labs(title = "                                                            time-dependent AUC",
#        y = "value", x = "time points") + 
#   facet_wrap(~ model)#+scale_y_continuous(limits=c(0,1))

g6=ggplot(plotdt2,aes(x=timepoint,y=Mean,color=model))+geom_line(aes(color=model))+scale_color_manual(values = mycolors, drop=FALSE) 
# print(g1)
# print(g2)
# print(g3)
# print(g4)
# print(g5)
# print(g6)
#print(ggarrange(g1,g2, g3,g4,g5,labels = c("c","c", "auc", "br","ibr"),ncol = 2, nrow = 3))
return(list(longdt,g1,g2,g3,g4,g5,g6,p1))
}

```

```{r}
characteristic_table=function(cox4){
cox4dt=bind_rows(cox4, .id = "column_label")
colnames(cox4dt)=c("model","hc","bc","unoc","ghc","bs1","bs2","bs3","bs4","bs5","bs6","auc1","auc2","auc3","auc4","auc5","auc6","auc7","auc8","auc9","auc10","auc11","auc12","auc13","auc14","auc15","auc")
proportion=NULL
summaryy=NULL
if(sum(rowSums(is.na(cox4dt))==26)!=0){
  proportion=1-sum(rowSums(is.na(cox4dt))==26)/100
cox4dt=cox4dt[-which(rowSums(is.na(cox4dt))==26),]
summaryy=summary(cox4dt)}else{
  proportion=1
  summaryy=summary(cox4dt)
}
return(list(proportion,summaryy))
}
```

## pbc
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=readRDS("savedresults/pbc_cox1.rds")
cox2=readRDS("savedresults/pbc_bw_cox1.rds")
cox3=readRDS("savedresults/pbc_bw_cox2.rds")
cox4=readRDS("savedresults/pbc_bw_cox3.rds")
pcox1=readRDS("savedresults/pbc_p_cox1.rds")
pcox2=readRDS("savedresults/pbc_p_cox2.rds")
pcox3=readRDS("savedresults/pbc_p_cox3.rds")
rsf1=readRDS("savedresults/pbc_rsf1.rds")
rsf2=readRDS("savedresults/pbc_rsf2.rds")
mtlr1=readRDS("savedresults/pbc_mtlr.rds")
dnnsurv1=readRDS("savedresults/pbc_dnnsurv.rds")
coxboost=readRDS("savedresults/pbc_coxboost.rds")
gacox=empty_list
gamtlr=empty_list
gacoxboost=empty_list
limmamtlr=empty_list
limmacoxboost=empty_list
survivalsvm=readRDS("savedresults/pbc_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
pbcfull=want[[1]]
g1=want[[2]]
g2=want[[3]]
g3=want[[4]]
g4=want[[5]]
g5=want[[6]]
g6=want[[7]]
g7=want[[8]]
characteristic_table(dnnsurv1)[[1]]
```

## veteran
```{r}
cox1=readRDS("savedresults/veteran_cox1.rds")
cox2=readRDS("savedresults/veteran_bw_cox1.rds")
cox3=readRDS("savedresults/veteran_bw_cox2.rds")
cox4=readRDS("savedresults/veteran_bw_cox3.rds")
pcox1=readRDS("savedresults/veteran_p_cox1.rds")
pcox2=readRDS("savedresults/veteran_p_cox2.rds")
pcox3=readRDS("savedresults/veteran_p_cox3.rds")
rsf1=readRDS("savedresults/veteran_rsf1.rds")
rsf2=readRDS("savedresults/veteran_rsf2.rds")
mtlr1=readRDS("savedresults/veteran_mtlr.rds")
dnnsurv1=readRDS("savedresults/veteran_dnnsurv.rds")
coxboost=readRDS("savedresults/veteran_coxboost.rds")
gacox=empty_list
gamtlr=empty_list
gacoxboost=empty_list
limmamtlr=empty_list
limmacoxboost=empty_list
survivalsvm=readRDS("savedresults/veteran_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
veteranfull=want[[1]]
g8=want[[2]]
g9=want[[3]]
g10=want[[4]]
g11=want[[5]]
g12=want[[6]]
g13=want[[7]]
g14=want[[8]]

characteristic_table(dnnsurv1)[[1]]
```

## lung
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=readRDS("savedresults/lung_cox1.rds")
cox2=readRDS("savedresults/lung_bw_cox1.rds")
cox3=readRDS("savedresults/lung_bw_cox2.rds")
cox4=readRDS("savedresults/lung_bw_cox3.rds")
pcox1=readRDS("savedresults/lung_p_cox1.rds")
pcox2=readRDS("savedresults/lung_p_cox2.rds")
pcox3=readRDS("savedresults/lung_p_cox3.rds")
rsf1=readRDS("savedresults/lung_rsf1.rds")
rsf2=readRDS("savedresults/lung_rsf2.rds")
mtlr1=readRDS("savedresults/lung_mtlr.rds")
dnnsurv1=readRDS("savedresults/lung_dnnsurv.rds")
coxboost=readRDS("savedresults/lung_coxboost.rds")
gacox=empty_list
gamtlr=empty_list
gacoxboost=empty_list
limmamtlr=empty_list
limmacoxboost=empty_list
survivalsvm=readRDS("savedresults/lung_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
lungfull=want[[1]]
g15=want[[2]]
g16=want[[3]]
g17=want[[4]]
g18=want[[5]]
g19=want[[6]]
g20=want[[7]]
g21=want[[8]]
characteristic_table(dnnsurv1)[[1]]
```


## ANZ
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=readRDS("savedresults/anz_cox1.rds")
cox2=readRDS("savedresults/anz_bw_cox1.rds")
cox3=readRDS("savedresults/anz_bw_cox2.rds")
cox4=readRDS("savedresults/anz_bw_cox3.rds")
pcox1=readRDS("savedresults/anz_p_cox1.rds")
pcox2=readRDS("savedresults/anz_p_cox2.rds")
pcox3=readRDS("savedresults/anz_p_cox3.rds")
rsf1=readRDS("savedresults/anz_rsf1.rds")
rsf2=readRDS("savedresults/anz_rsf2.rds")
mtlr1=readRDS("savedresults/anz_mtlr.rds")
dnnsurv1=readRDS("savedresults/anz_dnnsurv.rds")
coxboost=readRDS("savedresults/anz_coxboost.rds")
gacox=empty_list
gamtlr=empty_list
gacoxboost=empty_list
limmamtlr=empty_list
limmacoxboost=empty_list
survivalsvm=empty_list
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
anzfull=want[[1]]
g22=want[[2]]
g23=want[[3]]
g24=want[[4]]
g25=want[[5]]
g26=want[[6]]
g27=want[[7]]
g28=want[[8]]



characteristic_table(dnnsurv1)[[1]]
#characteristic_table(pcox3)
```

## US
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=readRDS("savedresults/us_cox1.rds")
cox2=empty_list
cox3=empty_list
cox4=empty_list
#pcox1=readRDS("US/cox4.rds")
 # for (i in 1:length(dnnsurv1)){
 #    if (class(dnnsurv1[[i]])=="try-error")
 #    dnnsurv1[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
 #    colnames(dnnsurv1[[i]])=c("hc", "bc", "unoc" ,"ghc" , "br1" , "br2" ,"br3","br4",  "br5", "br6" , "a1"  , "a2","a3" , "a4","a5" , "a6", "a7", "a8", "a9", "a10" , "a11" , "a12" , "a13",  "a14" , "a15" , "a")}
pcox1=readRDS("savedresults/us_p_cox1.rds")
pcox2=readRDS("savedresults/us_p_cox2.rds")
pcox3=readRDS("savedresults/us_p_cox3.rds")
rsf1=readRDS("savedresults/us_rsf1.rds")
rsf2=readRDS("savedresults/us_rsf2.rds")
mtlr1=readRDS("savedresults/us_mtlr.rds")
dnnsurv1=empty_list
coxboost=readRDS("savedresults/us_coxboost.rds")
gacox=empty_list
gamtlr=empty_list
gacoxboost=empty_list
limmamtlr=empty_list
limmacoxboost=empty_list
survivalsvm=empty_list
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
usfull=want[[1]]
g29=want[[2]]
g30=want[[3]]
g31=want[[4]]
g32=want[[5]]
g33=want[[6]]
g34=want[[7]]
g35=want[[8]]

#characteristic_table(rsf1)[[1]]
characteristic_table(pcox3)[[1]]
```


## melanoma_clinical
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=readRDS("savedresults/melanomaclinical_cox1.rds")
cox2=empty_list
cox3=empty_list
cox4=empty_list
#pcox1=readRDS("US/cox4.rds")
pcox1=readRDS("savedresults/melanomaclinical_p_cox1.rds")
pcox2=readRDS("savedresults/melanomaclinical_p_cox2.rds")
pcox3=readRDS("savedresults/melanomaclinical_p_cox3.rds")
rsf1=readRDS("savedresults/melanomaclinical_rsf1.rds")
rsf2=readRDS("savedresults/melanomaclinical_rsf2.rds")
mtlr1=readRDS("savedresults/melanomaclinical_mtlr.rds")
#dnnsurv1=readRDS("savedresults/melanomaclinical_dnnsurv.rds")
dnnsurv1=empty_list
# summ=0
#  for (i in 1:length(dnnsurv1)){
#     if (class(dnnsurv1[[i]])=="try-error"){
#       summ=summ+1
#     dnnsurv1[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{cox2[[i]]=cox2[[i]]}
#     colnames(dnnsurv1[[i]])=c("hc", "bc", "unoc" ,"ghc" , "br1" , "br2" ,"br3","br4",  "br5", "br6" , "a1"  , "a2","a3" , "a4","a5" , "a6", "a7", "a8", "a9", "a10" , "a11" , "a12" , "a13",  "a14" , "a15" , "a")}
# print(summ)

coxboost=readRDS("savedresults/melanomaclinica_coxboost.rds")
gacox=empty_list
gamtlr=empty_list
gacoxboost=empty_list
limmamtlr=empty_list
limmacoxboost=empty_list
survivalsvm=readRDS("savedresults/clinical_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
melanoma_clinicalfull=want[[1]]
g36=want[[2]]
g37=want[[3]]
g38=want[[4]]
g39=want[[5]]
g40=want[[6]]
g41=want[[7]]
g42=want[[8]]

#characteristic_table(dnnsurv1)[[1]]
```



## melanoma_itraq
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=empty_list
cox3=empty_list
cox4=empty_list
# cox2=readRDS("melanomaitraq2/melanomaitraq_bw_cox1.rds")
# summ=0
#  for (i in 1:length(cox2)){
#     if (class(cox2[[i]])=="try-error"){
#       summ=summ+1
#     cox2[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{cox2[[i]]=cox2[[i]]}
#     colnames(cox2[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
# print(summ)
# cox3=readRDS("melanomaitraq2/melanomaitraq_bw_cox2.rds")
# summ=0
#  for (i in 1:length(cox3)){
#     if (class(cox3[[i]])=="try-error"){
#       summ=summ+1
#     cox3[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{cox2[[i]]=cox2[[i]]}
#     colnames(cox3[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
# print(summ)
# cox4=readRDS("melanomaitraq2/melanomaitraq_bw_cox3.rds")
# summ=0
#  for (i in 1:length(cox4)){
#     if (class(cox4[[i]])=="try-error"){
#       summ=summ+1
#     cox4[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{cox2[[i]]=cox2[[i]]}
#     colnames(cox4[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
# print(summ)
#pcox1=readRDS("US/cox4.rds")
pcox1=readRDS("savedresults/melanomaitraq_p_cox1.rds")
pcox2=empty_list
pcox3=empty_list
rsf1=readRDS("savedresults/melanomaitraq_rsf1.rds")
rsf2=readRDS("savedresults/melanomaitraq_rsf2.rds")
#mtlr1=readRDS("melanomaitraq2/melanomaitraq_mtlr.rds")
#can no longer run
mtlr1=empty_list
dnnsurv1=readRDS("savedresults/melanomaitraq_dnnsurv.rds")

# rsf1=rsf1$value
# rsf2=rsf2$value
# mtlr1=mtlr1$value
coxboost=readRDS("savedresults/melanomaitraq_coxboost.rds")
gacox=readRDS("savedresults/itraq_ga_cox1.rds")
gamtlr=readRDS("savedresults/melanomaitraq_ga_mtlr.rds")
gacoxboost=readRDS("savedresults/melanomaitraq_ga_coxboost.rds")
limmamtlr=readRDS("savedresults/melanomaitraq_limma_mtlr.rds")
limmacoxboost=readRDS("savedresults/melanomaitraq_limma_coxboost.rds")
survivalsvm=readRDS("savedresults/itraq_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)



melanoma_itraqfull=want[[1]]
g43=want[[2]]
g44=want[[3]]
g45=want[[4]]
g46=want[[5]]
g47=want[[6]]
g48=want[[7]]
g49=want[[8]]

#characteristic_table(rsf1)[[2]]
characteristic_table(dnnsurv1)[[1]]
```


## melanoma_swath
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=empty_list
cox3=empty_list
cox4=empty_list
#pcox1=readRDS("US/cox4.rds")
pcox1=readRDS("savedresults/melanomaswath_p_cox1.rds")
pcox2=empty_list
pcox3=empty_list
rsf1=readRDS("savedresults/melanomaswath_rsf1.rds")
rsf2=readRDS("savedresults/melanomaswath_rsf2.rds")
mtlr1=readRDS("savedresults/melanomaswath_mtlr.rds")
dnnsurv1=empty_list
coxboost=readRDS("savedresults/melanomaswath_coxboost.rds")

gacox=readRDS("savedresults/melanomaswath_ga_cox1.rds")
gamtlr=readRDS("savedresults/melanomaswath_ga_mtlr.rds")
gacoxboost=readRDS("savedresults/melanomaswath_ga_coxboost.rds")
limmamtlr=readRDS("savedresults/melanomaswath_limma_mtlr.rds")
limmacoxboost=readRDS("savedresults/melanomaswath_limma_coxboost.rds")
survivalsvm=readRDS("savedresults/melanomaswath_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
melanoma_swathfull=want[[1]]
g50=want[[2]]
g51=want[[3]]
g52=want[[4]]
g53=want[[5]]
g54=want[[6]]
g55=want[[7]]
g56=want[[8]]



```

## melanomanano
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=readRDS("savedresults/melanomanano_bw_cox1.rds")
summ=0
 for (i in 1:length(cox2)){
    if (class(cox2[[i]])=="try-error"){
      summ=summ+1
    cox2[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{cox2[[i]]=cox2[[i]]}
    colnames(cox2[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)
cox3=readRDS("savedresults/melanomanano_bw_cox2.rds")
summ=0
 for (i in 1:length(cox3)){
    if (class(cox3[[i]])=="try-error"){
      summ=summ+1
    cox3[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{cox2[[i]]=cox2[[i]]}
    colnames(cox3[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)
cox4=readRDS("savedresults/melanomanano_bw_cox3.rds")
summ=0
 for (i in 1:length(cox4)){
    if (class(cox4[[i]])=="try-error"){
      summ=summ+1
    cox4[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{cox2[[i]]=cox2[[i]]}
    colnames(cox4[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)
pcox1=readRDS("savedresults/melanomanano_p_cox1.rds")
summ=0
 for (i in 1:length(pcox1)){
    if (class(pcox1[[i]])=="try-error"){
      summ=summ+1
    pcox1[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{pcox1[[i]]=pcox1[[i]]}
    colnames(pcox1[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)
pcox2=readRDS("savedresults/melanomanano_p_cox2.rds")
summ=0
 for (i in 1:length(pcox2)){
    if (class(pcox2[[i]])=="try-error"){
      summ=summ+1
    pcox2[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{pcox2[[i]]=pcox2[[i]]}
    colnames(pcox2[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)
pcox3=readRDS("savedresults/melanomanano_p_cox3.rds")
summ=0
 for (i in 1:length(pcox3)){
    if (class(pcox3[[i]])=="try-error"){
      summ=summ+1
    pcox3[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{pcox3[[i]]=pcox3[[i]]}
    colnames(pcox3[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)
rsf1=readRDS("savedresults/melanomanano_rsf1.rds")
summ=0
 for (i in 1:length(rsf1)){
    if (class(rsf1[[i]])=="try-error"){
      summ=summ+1
    rsf1[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{rsf1[[i]]=rsf1[[i]]}
    colnames(rsf1[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)
rsf2=readRDS("savedresults/melanomanano_rsf2.rds")
summ=0
 for (i in 1:length(rsf2)){
    if (class(rsf2[[i]])=="try-error"){
      summ=summ+1
    rsf2[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{rsf2[[i]]=rsf2[[i]]}
    colnames(rsf2[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)
mtlr1=readRDS("savedresults/melanomanano_mtlr.rds")
summ=0
 for (i in 1:length(mtlr1)){
    if (class(mtlr1[[i]])=="try-error"){
      summ=summ+1
    mtlr1[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{mtlr1[[i]]=mtlr1[[i]]}
    colnames(mtlr1[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)
dnnsurv1=readRDS("savedresults/melanomanano_dnnsurv.rds")
summ=0
 for (i in 1:length(dnnsurv1)){
    if (class(dnnsurv1[[i]])=="try-error"){
      summ=summ+1
    dnnsurv1[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{dnnsurv1[[i]]=dnnsurv1[[i]]}
    colnames(dnnsurv1[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)
coxboost=readRDS("savedresults/melanomanano_coxboost.rds")
summ=0
 for (i in 1:length(coxboost)){
    if (class(coxboost[[i]])=="try-error"){
      summ=summ+1
    coxboost[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))}else{coxboost[[i]]=coxboost[[i]]}
    colnames(coxboost[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")}
print(summ)

gacox=empty_list
gamtlr=empty_list
gacoxboost=empty_list
limmamtlr=empty_list
limmacoxboost=empty_list
survivalsvm=empty_list
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
melanomananofull=want[[1]]
g57=want[[2]]
g58=want[[3]]
g59=want[[4]]
g60=want[[5]]
g61=want[[6]]
g62=want[[7]]
g63=want[[8]]

characteristic_table(rsf1)[[2]]
characteristic_table(pcox1)[[1]]
characteristic_table(pcox1)[[2]]
characteristic_table(pcox3)[[2]]
characteristic_table(dnnsurv1)[[1]]
```




## gse1
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=empty_list
cox3=empty_list
cox4=empty_list
pcox1=readRDS("savedresults/gse1_p_cox1.rds")
pcox2=readRDS("savedresults/gse1_p_cox2.rds")
pcox3=readRDS("savedresults/gse1_p_cox3.rds")
rsf1=readRDS("savedresults/gse1_rsf1.rds")
rsf2=readRDS("savedresults/gse1_rsf2.rds")
mtlr1=readRDS("savedresults/gse1_mtlr.rds")
dnnsurv1=empty_list
coxboost=readRDS("savedresults/gse1_coxboost.rds")

gacox=readRDS("savedresults/gse1_ga_cox1.rds")
gamtlr=readRDS("savedresults/gse1_ga_mtlr.rds")
gacoxboost=readRDS("savedresults/gse1_ga_coxboost.rds")
limmamtlr=readRDS("savedresults/gse1_limma_mtlr.rds")
limmacoxboost=readRDS("savedresults/gse1_limma_coxboost.rds")
survivalsvm=readRDS("savedresults/gse1_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
gse1full=want[[1]]
g64=want[[2]]
g65=want[[3]]
g66=want[[4]]
g67=want[[5]]
g68=want[[6]]
g69=want[[7]]
g70=want[[8]]

characteristic_table(pcox1)[[2]]
```

## gse2
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=empty_list
cox3=empty_list
cox4=empty_list
pcox1=readRDS("savedresults/gse4_p_cox2.rds")
pcox2=readRDS("savedresults/gse4_p_cox2.rds")
pcox3=readRDS("savedresults/gse4_p_cox3.rds")
rsf1=readRDS("savedresults/gse4_rsf1.rds") 
rsf2=readRDS("savedresults/gse4_rsf1.rds") 
#mtlr1=readRDS("savedresults/gse4_mtlr.rds")
mtlr1=empty_list
dnnsurv1=empty_list
coxboost=readRDS("savedresults/gse4_coxboost.rds") 

gacox=readRDS("savedresults/gse4_ga_cox1.rds")
gamtlr=readRDS("savedresults/gse4_ga_mtlr.rds")
gacoxboost=readRDS("savedresults/gse4_ga_coxboost.rds")
limmamtlr=readRDS("savedresults/gse4_limma_mtlr.rds")
limmacoxboost=readRDS("savedresults/gse4_limma_coxboost.rds")
survivalsvm=readRDS("savedresults/gse4_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
gse2full=want[[1]]
g71=want[[2]]
g72=want[[3]]
g73=want[[4]]
g74=want[[5]]
g75=want[[6]]
g76=want[[7]]
g77=want[[8]]

characteristic_table(rsf1)[[2]]
```

## ngene1
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=empty_list
cox3=empty_list
cox4=empty_list
pcox1=readRDS("savedresults/ngse1_p_cox1.rds")
pcox2=readRDS("savedresults/ngse1_p_cox2.rds")
pcox3=readRDS("savedresults/ngse1_p_cox3.rds")
rsf1=readRDS("savedresults/ngse1_rsf1.rds") 
rsf2=readRDS("savedresults/ngse1_rsf1.rds") 
mtlr1=readRDS("savedresults/ngse1_mtlr.rds") 
dnnsurv1=readRDS("savedresults/ngse1_dnnsurv.rds") 
coxboost=readRDS("savedresults/ngse1_coxboost.rds") 

gacox=readRDS("savedresults/ngse1_ga_cox1.rds")
gamtlr=readRDS("savedresults/ngse1_ga_mtlr.rds")
gacoxboost=readRDS("savedresults/ngse1_ga_cocboost.rds")
limmamtlr=readRDS("savedresults/ngse1_limma_mtlr.rds")
#limmacoxboost=readRDS("NGSE/ngse1_limma_coxboost.rds")
limmacoxboost=empty_list
survivalsvm=readRDS("savedresults/ngse1_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
ngse1full=want[[1]]
g85=want[[2]]
g86=want[[3]]
g87=want[[4]]
g88=want[[5]]
g89=want[[6]]
g90=want[[7]]
g91=want[[8]]

characteristic_table(dnnsurv1)[[1]]
```

## ngene2
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=empty_list
cox3=empty_list
cox4=empty_list
pcox1=readRDS("savedresults/ngse2_p_cox1.rds")
pcox2=readRDS("savedresults/ngse2_p_cox2.rds")
pcox3=readRDS("savedresults/ngse2_p_cox3.rds")
rsf1=readRDS("savedresults/ngse2_rsf1.rds") 
rsf2=readRDS("savedresults/ngse2_rsf1.rds") 
mtlr1=readRDS("savedresults/ngse2_mtlr.rds") 
dnnsurv1=readRDS("savedresults/ngse2_dnnsurv.rds") 
coxboost=readRDS("savedresults/ngse2_coxboost.rds") 

gacox=readRDS("savedresults/ngse2_ga_cox1.rds")
gamtlr=readRDS("savedresults/ngse2_ga_mtlr.rds")
gacoxboost=readRDS("savedresults/ngse2_ga_cocboost.rds")
limmamtlr=readRDS("savedresults/ngse2_limma_mtlr.rds")
limmacoxboost=readRDS("savedresults/ngse2_limma_coxboost.rds")
survivalsvm=readRDS("savedresults/ngse2_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
ngse2full=want[[1]]
g92=want[[2]]
g93=want[[3]]
g94=want[[4]]
g95=want[[5]]
g96=want[[6]]
g97=want[[7]]
g98=want[[8]]
characteristic_table(dnnsurv1)[[1]]
```

## ngene3
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=empty_list
cox3=empty_list
cox4=empty_list
pcox1=readRDS("savedresults/ngse3_p_cox1.rds")
pcox2=readRDS("savedresults/ngse3_p_cox2.rds")
pcox3=readRDS("savedresults/ngse3_p_cox3.rds")
rsf1=readRDS("savedresults/ngse3_rsf1.rds") 
rsf2=readRDS("savedresults/ngse3_rsf1.rds") 
mtlr1=readRDS("savedresults/ngse3_mtlr.rds") 
dnnsurv1=readRDS("savedresults/ngse3_dnnsurv.rds") 
coxboost=readRDS("savedresults/ngse3_coxboost.rds") 

gacox=readRDS("savedresults/ngse3_ga_cox1.rds")
gamtlr=readRDS("savedresults/ngse3_ga_mtlr.rds")
gacoxboost=readRDS("savedresults/ngse3_ga_cocboost.rds")
limmamtlr=readRDS("savedresults/ngse3_limma_mtlr.rds")
limmacoxboost=readRDS("savedresults/ngse3_limma_coxboost.rds")
survivalsvm=empty_list
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
ngse3full=want[[1]]
g99=want[[2]]
g100=want[[3]]
g101=want[[4]]
g102=want[[5]]
g103=want[[6]]
g104=want[[7]]
g105=want[[8]]

characteristic_table(dnnsurv1)[[1]]
```

## ngene4
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=empty_list
cox3=empty_list
cox4=empty_list
pcox1=readRDS("savedresults/ngse4_p_cox1.rds")
pcox2=readRDS("savedresults/ngse4_p_cox2.rds")
pcox3=readRDS("savedresults/ngse4_p_cox3.rds")
rsf1=readRDS("savedresults/ngse4_rsf1.rds") 
rsf2=readRDS("savedresults/ngse4_rsf1.rds") 
mtlr1=readRDS("savedresults/ngse4_mtlr.rds") 
dnnsurv1=readRDS("savedresults/ngse4_dnnsurv.rds") 
coxboost=readRDS("savedresults/ngse4_coxboost.rds") 

gacox=readRDS("savedresults/ngse4_ga_cox1.rds")
gamtlr=readRDS("savedresults/ngse4_ga_mtlr.rds")
gacoxboost=readRDS("savedresults/ngse4_ga_cocboost.rds")
limmamtlr=readRDS("savedresults/ngse4_limma_mtlr.rds")
limmacoxboost=readRDS("savedresults/ngse4_limma_coxboost.rds")
survivalsvm=readRDS("savedresults/ngse4_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
ngse4full=want[[1]]
g106=want[[2]]
g107=want[[3]]
g108=want[[4]]
g109=want[[5]]
g110=want[[6]]
g111=want[[7]]
g112=want[[8]]

characteristic_table(dnnsurv1)[[1]]
```

## ngene5
```{r}
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=empty_list
cox3=empty_list
cox4=empty_list
pcox1=readRDS("savedresults/ngse5_p_cox1.rds")
pcox2=readRDS("savedresults/ngse5_p_cox2.rds")
pcox3=readRDS("savedresults/ngse5_p_cox3.rds")
rsf1=readRDS("savedresults/ngse5_rsf1.rds") 
rsf2=readRDS("savedresults/ngse5_rsf1.rds") 
mtlr1=readRDS("savedresults/ngse5_mtlr.rds") 
dnnsurv1=readRDS("savedresults/ngse5_dnnsurv.rds") 
coxboost=readRDS("savedresults/ngse5_coxboost.rds") 

gacox=readRDS("savedresults/ngse5_ga_cox1.rds")
gamtlr=readRDS("savedresults/ngse5_ga_mtlr.rds")
gacoxboost=readRDS("savedresults/ngse5_ga_cocboost.rds")
limmamtlr=readRDS("savedresults/ngse5_limma_mtlr.rds")
limmacoxboost=readRDS("savedresults/ngse5_limma_coxboost.rds")
survivalsvm=readRDS("savedresults/ngse5_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
ngse5full=want[[1]]
g113=want[[2]]
g114=want[[3]]
g115=want[[4]]
g116=want[[5]]
g117=want[[6]]
g118=want[[7]]
g119=want[[8]]
characteristic_table(dnnsurv1)[[1]]
```

## ngene6
```{r }
empty_list=list()
for(i in 1:50){
  empty_list[[i]]=data.frame(matrix(NA, ncol = 26, nrow = 5))
  colnames(empty_list[[i]])=c("hc_acc5", "bc_acc5", "unoc_acc5" ,"ghc_acc5" , "bs1" , "bs2" ,"bs3","bs4",  "bs5", "bs6" , "auc1"  , "auc2","auc3" , "auc4","auc5" , "auc6", "auc7", "auc8", "auc9", "auc10" , "auc11" , "auc12" , "auc13",  "auc14" , "auc15" , "auc")
}
cox1=empty_list
cox2=empty_list
cox3=empty_list
cox4=empty_list
pcox1=readRDS("savedresults/ngse6_p_cox1.rds")
pcox2=readRDS("savedresults/ngse6_p_cox2.rds")
pcox3=readRDS("savedresults/ngse6_p_cox3.rds")
rsf1=readRDS("savedresults/ngse6_rsf1.rds") 
rsf2=readRDS("savedresults/ngse6_rsf1.rds") 
mtlr1=readRDS("savedresults/ngse6_mtlr.rds") 
dnnsurv1=readRDS("savedresults/ngse6_dnnsurv.rds") 
coxboost=readRDS("savedresults/ngse6_coxboost.rds") 

gacox=readRDS("savedresults/ngse6_ga_cox1.rds")
gamtlr=readRDS("savedresults/ngse6_ga_mtlr.rds")
gacoxboost=readRDS("savedresults/ngse6_ga_cocboost.rds")
limmamtlr=readRDS("savedresults/ngse6_limma_mtlr.rds")
limmacoxboost=readRDS("savedresults/ngse6_limma_coxboost.rds")
survivalsvm=readRDS("savedresults/ngse6_survivalsvm.rds")
want=plot_fun(cox1, cox2, cox3, cox4, pcox1, pcox2, pcox3, rsf1, rsf2, mtlr1, dnnsurv1,coxboost,gacox,gamtlr,gacoxboost,limmamtlr,limmacoxboost,survivalsvm)
ngse6full=want[[1]]
g120=want[[2]]
g121=want[[3]]
g122=want[[4]]
g123=want[[5]]
g124=want[[6]]
g125=want[[7]]
g126=want[[8]]

characteristic_table(dnnsurv1)[[1]]
```



# each plot
```{r fig.height=40, fig.width=20}
labelss<-c("pbc","veteran","lung","anz","us","melanoma_clinical","melanoma_itraq","melanoma_swath","melanoma_nano","gse1","gse2","gene1","gene2","gene3","gene4","gene5","gene6")
ggarrange(g1,g8,g15,g22,g29,g36,g43,g50,g57,g64,g71,g85,g92,g99,g106,g113,g120,labels = labelss,ncol = 3, nrow = 6) #miss g78 for gse3
ggarrange(g6,g13, g20,g27,g34,g41,g48,g55,g62,g69,g76,g90,g97,g104,g111,g118,g125,labels = labelss,ncol = 3, nrow = 6) #g83
ggarrange(g5,g12, g19,g26,g33,g40,g47,g54,g61,g68,g75,g89,g96,g103,g110,g117,g124,labels = labelss,ncol = 3, nrow = 6) #g82
# ggarrange(g2,g9, g16,g23,g30,g35,g44,g51,g58,g65,g72,g79,labels = labelss,ncol = 3, nrow = 4)
# ggarrange(g4,g11, g18,g25,g32,g37,g46,g53,g60,g67,g74,g81,labels = labelss,ncol = 3, nrow = 4)
```

# combined plot

## data summary
```{r}
cen=read_excel("result.xlsx",sheet = 2)
kable(cen)
```

## feasibility summary

```{r}
plotdt=read_excel("result.xlsx",sheet = 1)
plotdt=as.data.frame(plotdt)
rownames(plotdt)=plotdt$method
#pheatmap(as.matrix(plotdt[,-1]),cluster_rows = FALSE,cluster_cols = TRUE)
col_fun = colorRamp2(c( 0, 1), c("seagreen", "lightpink"))
mat=as.matrix(plotdt[,-1])
Heatmap(mat, name = "index", col = col_fun,cluster_rows = FALSE,rect_gp = gpar(col = "white", lwd = 2))



plotdt=read_excel("result.xlsx",sheet = 7)
plotdt=as.data.frame(plotdt)
rownames(plotdt)=plotdt$method
#pheatmap(as.matrix(plotdt[,-1]),cluster_rows = FALSE,cluster_cols = TRUE)
col_fun = colorRamp2(c( 0, 1), c("seagreen", "lightpink"))
mat=as.matrix(plotdt[,-1])
Heatmap(mat, name = "index", col = col_fun,cluster_rows = FALSE,rect_gp = gpar(col = "white", lwd = 2))


```




## clinical vs omics
```{r}

data_list=list(anzfull,usfull,veteranfull,lungfull,pbcfull,melanoma_clinicalfull,melanoma_itraqfull,melanoma_swathfull,melanomananofull,gse1full,gse2full,ngse1full,ngse2full,ngse3full,ngse4full,ngse5full,ngse6full)
datafull=bind_rows(data_list, .id = "datasets")

nb.cols <- 17
mycolors <- colorRampPalette(brewer.pal(8, "RdBu"))(nb.cols)

plotdt=datafull[datafull$model=="rsf2",]
plotdt=plotdt[plotdt$variable=="bs5",]
plotdt2=plotdt[!is.infinite(plotdt$value),]
#plotdt2$observations=as.numeric(mapvalues(plotdt2$datasets, from = seq(1,11,1), to = c(3323,3000,137,228,312,88,41,70,45,194,58)))
#plotdt2=plotdt2 %>% arrange(observations)
#plotdt$datasets=factor(plotdt$datasets,levels=c("anzfull","usfull","veteranfull","lungfull","ovarianfull","melanoma_clinicalfull","melanoma_itraqfull","melanoma_swathfull","ovarian1full","ovarian2full"))
plotdt2$datasets=mapvalues(plotdt2$datasets, from = seq(1,17,1), to = c("anz3323","us3000","veteran137","lung228","pbc312","melanoma_clinical88","melanoma_itraq41","melanoma_swath70","melanoma_nano45","gse1 194","gse2 58","ngene1 115","ngene2 295","mgene3 86","ngene4 116","ngene5 78","ngene6 240"))
plotdt2$datasets=factor(plotdt2$datasets,levels=c("melanoma_itraq41","melanoma_nano45","gse2 58","melanoma_swath70","ngene5 78","mgene3 86","ngene1 115","ngene4 116","gse1 194","ngene6 240","ngene2 295","melanoma_clinical88","veteran137","lung228","pbc312","us3000","anz3323"))
p=ggplot(plotdt2, aes(x=datasets, y=value, fill=datasets)) + geom_boxplot()+scale_y_continuous(limits=c(0,0.25))+ scale_fill_manual(values = mycolors)
p


plotdt=datafull[datafull$model=="coxboost",]
plotdt=plotdt[plotdt$variable=="hc",]
plotdt2=plotdt[!is.infinite(plotdt$value),]

#plotdt$datasets=factor(plotdt$datasets,levels=c("anzfull","usfull","veteranfull","lungfull","ovarianfull","melanoma_clinicalfull","melanoma_itraqfull","melanoma_swathfull","ovarian1full","ovarian2full"))
plotdt2$datasets=mapvalues(plotdt2$datasets, from = seq(1,17,1), to = c("anz3323","us3000","veteran137","lung228","pbc312","melanoma_clinical88","melanoma_itraq41","melanoma_swath70","melanoma_nano45","gse1 194","gse2 58","ngene1 115","ngene2 295","mgene3 86","ngene4 116","ngene5 78","ngene6 240"))
plotdt2$datasets=factor(plotdt2$datasets,levels=c("melanoma_itraq41","melanoma_nano45","gse2 58","melanoma_swath70","ngene5 78","mgene3 86","ngene1 115","ngene4 116","gse1 194","ngene6 240","ngene2 295","melanoma_clinical88","veteran137","lung228","pbc312","us3000","anz3323"))
p=ggplot(plotdt2, aes(x=datasets, y=value, fill=datasets)) + geom_boxplot()+scale_y_continuous(limits=c(0,1))+ scale_fill_manual(values = mycolors)
p

```

## mean hc (data*method)
```{r}
plotdt=datafull[datafull$variable=="hc",]
plotdt2 <- plotdt %>%dplyr::group_by(datasets,model) %>%dplyr::summarize(Mean = mean(value, na.rm=TRUE))
plotdt2$datasets=plyr::mapvalues(plotdt2$datasets, from = seq(1,17,1), to = c("anz","us","veteran","lung","pbc","melanoma_clinical","melanoma_itraq","melanoma_swath","melanoma_nano","gse1","gse2","ngene1","ngene2","mgene3","ngene4","ngene5","ngene6"))
plotdt2$datasets=factor(plotdt2$datasets,levels=c("anz","us","veteran","lung","pbc","melanoma_clinical","melanoma_itraq","melanoma_swath","melanoma_nano","gse1","gse2","ngene1","ngene2","mgene3","ngene4","ngene5","ngene6"))
mat=tidyr::spread(plotdt2, model, Mean)
mat=as.data.frame(mat)
rownames(mat)=mat$datasets
mat=as.matrix(mat[,-1])
Heatmap(mat, name = "index", cluster_rows = FALSE,cluster_columns = FALSE,rect_gp = gpar(col = "white", lwd = 2))
```

## performance (model*metric, average over datasets)
```{r}
plotaccuracy=datafull[!(datafull$variable %in% c("bs1","bs2","bs3","bs4","bs5","bs6")),]
plotdtt=plotaccuracy%>% group_by(model,variable) %>%dplyr::summarize(Mean = mean(value, na.rm=TRUE))
mat=tidyr::spread(plotdtt, model, Mean)
mat=as.data.frame(mat)
mat=do.call(data.frame,lapply(mat, function(x) replace(x, is.infinite(x),NA)))
rownames(mat)=c("Harrell C","Begg C","Uno C","GH C","AUC1","AUC2","AUC3","AUC4","AUC5","AUC6","AUC7","AUC8","AUC9","AUC10","AUC11","AUC12","AUC13","AUC14","AUC15","integrated AUC")
colnames(mat)=c("variable","cox","cox+bwAIC","cox+bwp","cox+bwBIC","coxboost","dnnsurv","gacox","gacoxboost","gamtlr","limmacoxboost","limmamtlr","mtlr","LassoCox","RidgeCox","ElasticNetCox","RSF1","RSF2","survivalsvm")
mat=as.matrix(mat[,-1])
col_fun = colorRamp2(c( 0,0.5,1), c("seagreen", "grey","lightpink"))
Heatmap(mat, name = "index", col = col_fun,cluster_rows = FALSE,cluster_columns = FALSE,rect_gp = gpar(col = "white", lwd = 2))


plotaccuracy=datafull[(datafull$variable %in% c("bs1","bs2")),]
plotdtt=plotaccuracy%>% group_by(model,variable) %>%dplyr::summarize(Mean = mean(value, na.rm=TRUE))
mat=tidyr::spread(plotdtt, model, Mean)
mat=as.data.frame(mat)
mat=do.call(data.frame,lapply(mat, function(x) replace(x, is.infinite(x),NA)))
rownames(mat)=c("Brier score 1","Brier score 2")
colnames(mat)=c("variable","cox","cox+bwAIC","cox+bwp","cox+bwBIC","coxboost","dnnsurv","gacox","gacoxboost","gamtlr","limmacoxboost","limmamtlr","mtlr","LassoCox","RidgeCox","ElasticNetCox","RSF1","RSF2","survivalsvm")
mat=as.matrix(mat[,-1])

Heatmap(mat, name = "index",cluster_rows = FALSE,cluster_columns = FALSE,rect_gp = gpar(col = "white", lwd = 2))
```


## some picked comparison plots
```{r}
#1:anz
#16:ngene5
plotdt=datafull[datafull$model%in% c("cox1","cox2","cox3","pcox1","pcox2","pcox3","coxboost"),]
plotdt=plotdt[plotdt$variable=="hc"& plotdt$datasets==1,]
plotdt2=plotdt[!is.infinite(plotdt$value),]
ggplot(plotdt2, aes(x=model, y=value, fill=model)) + geom_boxplot()
plotdt=datafull[datafull$model%in% c("cox1","cox2","cox3","pcox1","pcox2","pcox3","coxboost"),]
plotdt=plotdt[plotdt$variable=="bs1"& plotdt$datasets==1,]
plotdt2=plotdt[!is.infinite(plotdt$value),]
ggplot(plotdt2, aes(x=model, y=value, fill=model)) + geom_boxplot()
plotdt=datafull[datafull$model%in% c("pcox1","coxboost","dnnsurv1","limmacoxboost"),]
plotdt=plotdt[plotdt$variable=="hc"& plotdt$datasets==16,]
plotdt2=plotdt[!is.infinite(plotdt$value),]
ggplot(plotdt2, aes(x=model, y=value, fill=model)) + geom_boxplot()
plotdt=datafull[datafull$model%in% c("pcox1","coxboost","dnnsurv1","limmacoxboost"),]
plotdt=plotdt[plotdt$variable=="bs1"& plotdt$datasets==16,]
plotdt2=plotdt[!is.infinite(plotdt$value),]
ggplot(plotdt2, aes(x=model, y=value, fill=model)) + geom_boxplot()


# plotdt=datafull[datafull$model%in% c("cox1","cox2","cox3","pcox1","pcox2","pcox3","coxboost","dnnsurv1"),]
# plotdt=plotdt[plotdt$variable=="hc"& plotdt$datasets==3,]
# plotdt2=plotdt[!is.infinite(plotdt$value),]
# ggplot(plotdt2, aes(x=model, y=value, fill=model)) + geom_boxplot()
# plotdt=datafull[datafull$model%in% c("cox1","cox2","cox3","pcox1","pcox2","pcox3","coxboost","dnnsurv1"),]
# plotdt=plotdt[plotdt$variable=="hc"& plotdt$datasets==4,]
# plotdt2=plotdt[!is.infinite(plotdt$value),]
# ggplot(plotdt2, aes(x=model, y=value, fill=model)) + geom_boxplot()
# plotdt=datafull[datafull$model%in% c("cox1","cox2","cox3","pcox1","pcox2","pcox3","coxboost","dnnsurv1"),]
# plotdt=plotdt[plotdt$variable=="hc"& plotdt$datasets==5,]
# plotdt2=plotdt[!is.infinite(plotdt$value),]
# ggplot(plotdt2, aes(x=model, y=value, fill=model)) + geom_boxplot()

```

## reproducibility
```{r}
plottdt=data.frame(method=rep(c("bw_aic","bw_p","bw_bic"),2),datasets=rep(c("m_itraq","m_nano"),each=3),failure=c(15,30,10,75,90,55))

ggplot(data = plottdt, aes(x = "", y = failure, fill = method )) + 
    geom_bar(stat = "identity", position = position_fill()) +
    geom_text(aes(label = failure), position = position_fill(vjust = 0.5)) +
    coord_polar(theta = "y") +
    facet_wrap(~ datasets)  +
    theme(axis.title.x = element_blank(),
          axis.title.y = element_blank()) + 
    theme(legend.position='bottom') + 
    guides(fill=guide_legend(nrow=2, byrow=TRUE))
```


```{r}
plottdt=read_excel("result.xlsx",sheet = 8)
plottdt=plottdt[11,]
plottdt=as.data.frame(t(plottdt))
plottdt$data=rownames(plottdt)
plottdt=plottdt[which(plottdt$V1>0),]
ggplot(data = plottdt[-1,], aes(x = "", y = V1, fill = data )) + geom_bar(stat = "identity", position = position_dodge())
  
```

```{r}
plottdt=data.frame(method=c("bw_coxaic","bw_coxp","bw_coxbic"),value=c(0.75,0.9,0.55))
ggplot(data = plottdt, aes(x = "", y = value, fill = method )) + geom_bar(stat = "identity", position = position_fill())+ coord_polar(theta = "y") +
    geom_text(aes(label = value), position = position_fill(vjust = 0.5))+
    theme(legend.position='bottom') + 
    guides(fill=guide_legend(nrow=1, byrow=TRUE))
```


# supplymentary

## linear model on cindex

check linear model: which aspect affects cindex
```{r eval=FALSE}
regressiondt=datafull%>% filter(variable=="hc")%>% group_by(datasets,model)%>% dplyr::summarise(medianc=median(value))
regressiondt$datasets=mapvalues(regressiondt$datasets, from = seq(1,11,1), to = c("anz","us","veteran","lung","pbc","melanoma_clinical","melanoma_itraq","melanoma_swath","melanoma_nano","gse1","gse2"))
tablee=read_excel("result.xlsx",sheet = 9)
regressiondt1 <- tablee %>% left_join(regressiondt, by = c("name" = "datasets"))
regressiondt2<-regressiondt1%>% distinct()

fitted=lm(medianc~.,data = regressiondt2[,-1])
summary(fitted)
head(regressiondt2)
stargazer(fitted, type = "text")
```

heatmap of cindex for model vs data
```{r eval=FALSE}
olddata_long=regressiondt2[,c(1,7,8)]
data_wide <- spread(olddata_long,model, medianc)
data_wide
plotdt=as.data.frame(data_wide)
rownames(plotdt)=plotdt$name
#pheatmap(as.matrix(plotdt[,-1]),cluster_rows = FALSE,cluster_cols = TRUE)
col_fun = colorRamp2(c( 0, 0.5,1), c("grey","seagreen", "lightpink"))
mat=as.matrix(plotdt[,-1])
mat[is.na(mat)] <- 0
Heatmap(mat, name = "index", col = col_fun,cluster_rows = FALSE,cluster_columns = FALSE,rect_gp = gpar(col = "white", lwd = 2))
```

check for this data pbc from another package: still, mtlr is bad
```{r eval=FALSE}
data("pbc",package = "survival")
dim(pbc)
colnames(pbc)

pbc1 <- pbc[,-1]
dim(pbc1)
any(is.na(pbc1))
pbc2=na.omit(pbc1)
dim(pbc2) #276 19
table(pbc2$status) 
pbc3=pbc2[pbc2$status!=1,]
pbc3$status=as.vector(ifelse(pbc3$status==2,1,0))
table(pbc3$status) #147 111
fitform_ogl=as.formula(Surv(time, status) ~ .)
summary(pbc3$time)

formula1=fitform_ogl
formula2=fitform_ogl
formula3=Surv(time,status)~1
formula4=Surv(time,status)~1
timess=seq(50,2000,(2000-50)/15)
#9

cox1 <- pbmcapply::pbmclapply(1:20, rsf2_fun,pbc3,5, fitform_ogl,formula1,formula2,formula3,formula4,timess, mc.cores = 2)

head(cox1)
colMeans(do.call(rbind, cox1))
#10

cox2 <- pbmcapply::pbmclapply(1:20, mtlr_fun,pbc3,5, fitform_ogl,formula1,formula2,formula3,formula4,timess, mc.cores = 2)

head(cox2)
colMeans(do.call(rbind, cox2))
```

## time and memory full report
```{r}
time_fun=function(model_list){
  time_vec=c()
for (i in 1:18){
  dt=model_list[[i]]
  if (is.null(dt)){time_vec[i]=NA} else {time_vec[i]=dt}
}
  return(time_vec)
}


memory_fun=function(model_list){
  memory_vec=c()
for (i in 1:18){
  dt=model_list[[i]]
  if (is.null(dt)){memory_vec[i]=NA} else {memory_vec[i]=sum(dt$by.total$mem.total)}
}
  return(memory_vec)
}

plot_fun1=function(valuee){
  df=data.frame(methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm"), value=valuee)
  p<-ggplot(data=df, aes(x=methods, y=value)) +
  geom_bar(stat="identity")+ggtitle("               memory(MB)")
  return(p)
}

plot_fun2=function(valuee){
  df=data.frame(methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm"), value=valuee)
  p<-ggplot(data=df, aes(x=methods, y=value)) +
  geom_bar(stat="identity")+ggtitle("                time(seconds)")
  return(p)
}

```



```{r}
#pbc
cox1=readRDS("savedresults/pbc_cox1m.rds")
cox2=readRDS("savedresults/pbc_bw_cox1m.rds")
cox3=readRDS("savedresults/pbc_bw_cox2m.rds")
cox4=readRDS("savedresults/pbc_bw_cox3m.rds")
pcox1=readRDS("savedresults/pbc_p_cox1m.rds")
pcox2=readRDS("savedresults/pbc_p_cox2m.rds")
pcox3=readRDS("savedresults/pbc_p_cox3m.rds")
rsf1=readRDS("savedresults/pbc_rsf1m.rds")
rsf2=readRDS("savedresults/pbc_rsf2m.rds")
mtlr1=readRDS("savedresults/pbc_mtlrm.rds")
dnnsurv1=readRDS("savedresults/pbc_dnnsurvm.rds")
coxboost=readRDS("savedresults/pbc_coxboostm.rds")
survivalsvm=readRDS("savedresults/pbc_survivalsvmm.rds")
ga_cox=NULL
ga_mtlr=NULL
ga_coxboost=NULL
limma_mtlr=NULL
limma_coxboost=NULL
survivalsvm=NULL
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=readRDS("savedresults/pbc_cox1t.rds")
tcox2=readRDS("savedresults/pbc_bw_cox1t.rds")
tcox3=readRDS("savedresults/pbc_bw_cox2t.rds")
tcox4=readRDS("savedresults/pbc_bw_cox3t.rds")
tpcox1=readRDS("savedresults/pbc_p_cox1t.rds")
tpcox2=readRDS("savedresults/pbc_p_cox2t.rds")
tpcox3=readRDS("savedresults/pbc_p_cox3t.rds")
trsf1=readRDS("savedresults/pbc_rsf1t.rds")
trsf2=readRDS("savedresults/pbc_rsf2t.rds")
tmtlr1=readRDS("savedresults/pbc_mtlrt.rds")
tdnnsurv1=readRDS("savedresults/pbc_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/pbc_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/pbc_survivalsvmt.rds")*60
tga_cox=NULL
tga_mtlr=NULL
tga_coxboost=NULL
tlimma_mtlr=NULL
tlimma_coxboost=NULL
tsurvivalsvm=NULL
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g1=plot_fun1(m)
g2=plot_fun2(t)
pbcall=cbind.data.frame(m,t,m1,t1)
pbcall$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#veteran
cox1=readRDS("savedresults/veteran_cox1m.rds")
cox2=readRDS("savedresults/veteran_bw_cox1m.rds")
cox3=readRDS("savedresults/veteran_bw_cox2m.rds")
cox4=readRDS("savedresults/veteran_bw_cox3m.rds")
pcox1=readRDS("savedresults/veteran_p_cox1m.rds")
pcox2=readRDS("savedresults/veteran_p_cox2m.rds")
pcox3=readRDS("savedresults/veteran_p_cox3m.rds")
rsf1=readRDS("savedresults/veteran_rsf1m.rds")
rsf2=readRDS("savedresults/veteran_rsf2m.rds")
mtlr1=readRDS("savedresults/veteran_mtlrm.rds")
dnnsurv1=readRDS("savedresults/veteran_dnnsurvm.rds")
coxboost=readRDS("savedresults/veteran_coxboostm.rds")
survivalsvm=readRDS("savedresults/veteran_survivalsvmm.rds")
ga_cox=NULL
ga_mtlr=NULL
ga_coxboost=NULL
limma_mtlr=NULL
limma_coxboost=NULL
survivalsvm=NULL
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=readRDS("savedresults/veteran_cox1t.rds")
tcox2=readRDS("savedresults/veteran_bw_cox1t.rds")
tcox3=readRDS("savedresults/veteran_bw_cox2t.rds")
tcox4=readRDS("savedresults/veteran_bw_cox3t.rds")
tpcox1=readRDS("savedresults/veteran_p_cox1t.rds")
tpcox2=readRDS("savedresults/veteran_p_cox2t.rds")
tpcox3=readRDS("savedresults/veteran_p_cox3t.rds")
trsf1=readRDS("savedresults/veteran_rsf1t.rds")
trsf2=readRDS("savedresults/veteran_rsf2t.rds")
tmtlr1=readRDS("savedresults/veteran_mtlrt.rds")
tdnnsurv1=readRDS("savedresults/veteran_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/veteran_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/veteran_survivalsvmt.rds")
tga_cox=NULL
tga_mtlr=NULL
tga_coxboost=NULL
tlimma_mtlr=NULL
tlimma_coxboost=NULL
tsurvivalsvm=NULL
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)
m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g3=plot_fun1(m)
g4=plot_fun2(t)
veteranall=cbind.data.frame(m,t,m1,t1)
veteranall$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#lung
cox1=readRDS("savedresults/lung_cox1m.rds")
cox2=readRDS("savedresults/lung_bw_cox1m.rds")
cox3=readRDS("savedresults/lung_bw_cox2m.rds")
pcox1=readRDS("savedresults/lung_p_cox1m.rds")
pcox2=readRDS("savedresults/lung_p_cox2m.rds")
pcox3=readRDS("savedresults/lung_p_cox3m.rds")
rsf1=readRDS("savedresults/lung_rsf1m.rds")
rsf2=readRDS("savedresults/lung_rsf2m.rds")
mtlr1=readRDS("savedresults/lung_mtlrm.rds")
dnnsurv1=readRDS("savedresults/lung_dnnsurvm.rds")
coxboost=readRDS("savedresults/lung_coxboostm.rds")
cox4=readRDS("savedresults/lung_bw_cox3m.rds")
survivalsvm=readRDS("savedresults/lung_survivalsvmm.rds")
ga_cox=NULL
ga_mtlr=NULL
ga_coxboost=NULL
limma_mtlr=NULL
limma_coxboost=NULL
survivalsvm=NULL
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=readRDS("savedresults/lung_cox1t.rds")
tcox2=readRDS("savedresults/lung_bw_cox1t.rds")
tcox3=readRDS("savedresults/lung_bw_cox2t.rds")
tpcox1=readRDS("savedresults/lung_p_cox1t.rds")
tpcox2=readRDS("savedresults/lung_p_cox2t.rds")
tpcox3=readRDS("savedresults/lung_p_cox3t.rds")
trsf1=readRDS("savedresults/lung_rsf1t.rds")
trsf2=readRDS("savedresults/lung_rsf2t.rds")
tmtlr1=readRDS("savedresults/lung_mtlrt.rds")
tdnnsurv1=readRDS("savedresults/lung_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/lung_coxboostt.rds")
tcox4=readRDS("savedresults/lung_bw_cox3t.rds")
tsurvivalsvm=readRDS("savedresults/lung_survivalsvmt.rds")
tga_cox=NULL
tga_mtlr=NULL
tga_coxboost=NULL
tlimma_mtlr=NULL
tlimma_coxboost=NULL
tsurvivalsvm=NULL
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g5=plot_fun1(m)
g6=plot_fun2(t)
lungall=cbind.data.frame(m,t,m1,t1)
lungall$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")

#anz
cox1=readRDS("savedresults/anz_cox1m.rds")
cox2=readRDS("savedresults/anz_bw_cox1m.rds")
cox3=readRDS("savedresults/anz_bw_cox2m.rds")
cox4=readRDS("savedresults/anz_bw_cox3m.rds")
pcox1=readRDS("savedresults/anz_p_cox1m.rds")
pcox2=readRDS("savedresults/anz_p_cox2m.rds")
pcox3=readRDS("savedresults/anz_p_cox3m.rds")
rsf1=readRDS("savedresults/anz_rsf1m.rds")
rsf2=readRDS("savedresults/anz_rsf2m.rds")
mtlr1=readRDS("savedresults/anz_mtlrm.rds")
dnnsurv1=readRDS("savedresults/anz_dnnsurvm.rds")
coxboost=readRDS("savedresults/anz_coxboostm.rds")
survivalsvm=NULL
ga_cox=NULL
ga_mtlr=NULL
ga_coxboost=NULL
limma_mtlr=NULL
limma_coxboost=NULL
survivalsvm=NULL
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=readRDS("savedresults/anz_cox1t.rds")
tcox2=readRDS("savedresults/anz_bw_cox1t.rds")
tcox3=readRDS("savedresults/anz_bw_cox2t.rds")
tcox4=readRDS("savedresults/anz_bw_cox3t.rds")
tpcox1=readRDS("savedresults/anz_p_cox1t.rds")*60
tpcox2=readRDS("savedresults/anz_p_cox2t.rds")
tpcox3=readRDS("savedresults/anz_p_cox3t.rds")*60
trsf1=readRDS("savedresults/anz_rsf1t.rds")*60
trsf2=readRDS("savedresults/anz_rsf2t.rds")*60
tmtlr1=readRDS("savedresults/anz_mtlrt.rds")*60
tdnnsurv1=readRDS("savedresults/anz_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/anz_coxboostt.rds")
tsurvivalsvm=NULL
tga_cox=NULL
tga_mtlr=NULL
tga_coxboost=NULL
tlimma_mtlr=NULL
tlimma_coxboost=NULL
tsurvivalsvm=NULL
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g7=plot_fun1(m)
g8=plot_fun2(t)
anzall=cbind.data.frame(m,t,m1,t1)
anzall$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#us
cox1=readRDS("savedresults/us_cox1m.rds")
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/us_p_cox1m.rds")
pcox2=readRDS("savedresults/us_p_cox2m.rds")
pcox3=readRDS("savedresults/us_p_cox3m.rds")
rsf1=readRDS("savedresults/us_rsf1m.rds")
rsf2=readRDS("savedresults/us_rsf2m.rds")
mtlr1=readRDS("savedresults/us_mtlrm.rds")
dnnsurv1=NULL
coxboost=readRDS("savedresults/us_coxboostm.rds")
survivalsvm=NULL
ga_cox=NULL
ga_mtlr=NULL
ga_coxboost=NULL
limma_mtlr=NULL
limma_coxboost=NULL
survivalsvm=NULL
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=readRDS("savedresults/us_cox1t.rds")
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/us_p_cox1t.rds")*3600
tpcox2=readRDS("savedresults/us_p_cox2t.rds")
tpcox3=readRDS("savedresults/us_p_cox3t.rds")*3600
trsf1=readRDS("savedresults/us_rsf1t.rds")*3600
trsf2=readRDS("savedresults/us_rsf2t.rds")*60
tmtlr1=readRDS("savedresults/us_mtlrt.rds")*3600
tdnnsurv1=NULL
tcoxboost=readRDS("savedresults/us_coxboostt.rds")
tsurvivalsvm=NULL
tga_cox=NULL
tga_mtlr=NULL
tga_coxboost=NULL
tlimma_mtlr=NULL
tlimma_coxboost=NULL
tsurvivalsvm=NULL
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g9=plot_fun1(m)
g10=plot_fun2(t)
usall=cbind.data.frame(m,t,m1,t1)
usall$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#melanomaclinical

cox1=readRDS("savedresults/melanomaclinical_cox1m.rds")
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/melanomaclinical_p_cox1m.rds")
pcox2=readRDS("savedresults/melanomaclinical_p_cox2m.rds")
pcox3=readRDS("savedresults/melanomaclinical_p_cox3m.rds")
rsf1=readRDS("savedresults/melanomaclinical_rsf1m.rds")
rsf2=readRDS("savedresults/melanomaclinical_rsf2m.rds")
mtlr1=readRDS("savedresults/melanomaclinical_mtlrm.rds")
dnnsurv1=readRDS("savedresults/melanomaclinical_dnnsurvm.rds")
coxboost=readRDS("savedresults/melanomaclinica_coxboostm.rds")
survivalsvm=NULL
ga_cox=NULL
ga_mtlr=NULL
ga_coxboost=NULL
limma_mtlr=NULL
limma_coxboost=NULL
survivalsvm=NULL
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=readRDS("savedresults/melanomaclinical_cox1t.rds")
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/melanomaclinical_p_cox1t.rds")
tpcox2=readRDS("savedresults/melanomaclinical_p_cox2t.rds")
tpcox3=readRDS("savedresults/melanomaclinical_p_cox3t.rds")
trsf1=readRDS("savedresults/melanomaclinical_rsf1t.rds")*60
trsf2=readRDS("savedresults/melanomaclinical_rsf2t.rds")
tmtlr1=readRDS("savedresults/melanomaclinical_mtlrt.rds")
tdnnsurv1=readRDS("savedresults/melanomaclinical_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/melanomaclinica_coxboostt.rds")
tsurvivalsvm=NULL
tga_cox=NULL
tga_mtlr=NULL
tga_coxboost=NULL
tlimma_mtlr=NULL
tlimma_coxboost=NULL
tsurvivalsvm=NULL
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)


m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g11=plot_fun1(m)
g12=plot_fun2(t)
melanomaclinicalall=cbind.data.frame(m,t,m1,t1)
melanomaclinicalall$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")

#melanomaitraq
cox1=NULL
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/melanomaitraq_p_cox1m.rds")
pcox2=NULL
pcox3=NULL
rsf1=readRDS("savedresults/melanomaitraq_rsf1m.rds")
rsf2=readRDS("savedresults/melanomaitraq_rsf2m.rds")
mtlr1=readRDS("savedresults/melanomaitraq_mtlrm.rds")
dnnsurv1=readRDS("savedresults/melanomaitraq_dnnsurvm.rds")
coxboost=readRDS("savedresults/melanomaitraq_coxboostm.rds")
ga_cox=readRDS("savedresults/itraq_ga_cox1m.rds")
ga_mtlr=readRDS("savedresults/melanomaitraq_ga_mtlrm.rds")
ga_coxboost=readRDS("savedresults/melanomaitraq_ga_coxboostm.rds")
limma_mtlr=readRDS("savedresults/melanomaitraq_limma_mtlrm.rds")
limma_coxboost=readRDS("savedresults/melanomaitraq_limma_coxboostm.rds")
survivalsvm=readRDS("savedresults/itraq_survivalsvmm.rds")
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/melanomaitraq_p_cox1t.rds")
tpcox2=NULL
tpcox3=NULL
trsf1=readRDS("savedresults/melanomaitraq_rsf1t.rds")
trsf2=readRDS("savedresults/melanomaitraq_rsf2t.rds")
tmtlr1=readRDS("savedresults/melanomaitraq_mtlrt.rds")*60
tdnnsurv1=readRDS("savedresults/melanomaitraq_dnnsurvt.rds")
tcoxboost=readRDS("savedresults/melanomaitraq_coxboostt.rds")
tga_cox=readRDS("savedresults/itraq_ga_cox1t.rds")
tga_mtlr=readRDS("savedresults/melanomaitraq_ga_mtlrt.rds")
tga_coxboost=readRDS("savedresults/melanomaitraq_ga_coxboostt.rds")
tlimma_mtlr=readRDS("savedresults/melanomaitraq_limma_mtlrt.rds")
tlimma_coxboost=readRDS("savedresults/melanomaitraq_limma_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/itraq_survivalsvmt.rds")
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g13=plot_fun1(m)
g14=plot_fun2(t)
melanomaitraqall=cbind.data.frame(m,t,m1,t1)
melanomaitraqall$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#melanomaswath
cox1=NULL
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/melanomaswath_p_cox1m.rds")
pcox2=NULL
pcox3=NULL
rsf1=readRDS("savedresults/melanomaswath_rsf1m.rds")
rsf2=readRDS("savedresults/melanomaswath_rsf2m.rds")
mtlr1=readRDS("savedresults/melanomaswath_mtlrm.rds")
dnnsurv1=NULL
coxboost=readRDS("savedresults/melanomaswath_coxboostm.rds")
ga_cox=readRDS("savedresults/melanomaswath_ga_cox1m.rds")
ga_mtlr=readRDS("savedresults/melanomaswath_ga_mtlrm.rds")
ga_coxboost=readRDS("savedresults/melanomaswath_ga_coxboostm.rds")
limma_mtlr=readRDS("savedresults/melanomaswath_limma_mtlrm.rds")
limma_coxboost=readRDS("savedresults/melanomaswath_limma_coxboostm.rds")
survivalsvm=readRDS("savedresults/melanomaswath_survivalsvmm.rds")
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/melanomaswath_p_cox1t.rds")
tpcox2=NULL
tpcox3=NULL
trsf1=readRDS("savedresults/lmelanomaswath_rsf1t.rds")*60
trsf2=readRDS("savedresults/melanomaswath_rsf2t.rds")
tmtlr1=readRDS("savedresults/melanomaswath_mtlrt.rds")*60
tdnnsurv1=NULL
tcoxboost=readRDS("savedresults/melanomaswath_coxboostt.rds")
tga_cox=readRDS("savedresults/melanomaswath_ga_cox1t.rds")*60
tga_mtlr=readRDS("savedresults/melanomaswath_ga_mtlrt.rds")*60
tga_coxboost=readRDS("savedresults/melanomaswath_ga_coxboostt.rds")*60
tlimma_mtlr=readRDS("savedresults/melanomaswath_limma_mtlrt.rds")
tlimma_coxboost=readRDS("savedresults/melanomaswath_limma_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/melanomaswath_survivalsvmt.rds")
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)
m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g15=plot_fun1(m)
g16=plot_fun2(t)
melanomaswathall=cbind.data.frame(m,t,m1,t1)
melanomaswathall$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#melanomanano
cox1=NULL
cox2=readRDS("savedresults/melanomanano_bw_cox1m.rds")
cox3=readRDS("savedresults/melanomanano_bw_cox2m.rds")
cox4=readRDS("savedresults/melanomanano_bw_cox3m.rds")
pcox1=readRDS("savedresults/melanomanano_p_cox1m.rds")
pcox2=readRDS("savedresults/melanomanano_p_cox2m.rds")
pcox3=readRDS("savedresults/melanomanano_p_cox3m.rds")
rsf1=readRDS("savedresults/melanomanano_rsf1m.rds")
rsf2=readRDS("savedresults/melanomanano_rsf2m.rds")
mtlr1=readRDS("savedresults/melanomanano_mtlrm.rds")
dnnsurv1=readRDS("savedresults/melanomanano_dnnsurvm.rds")
coxboost=readRDS("savedresults/melanomanano_coxboostm.rds")

survivalsvm=NULL
ga_cox=NULL
ga_mtlr=NULL
ga_coxboost=NULL
limma_mtlr=NULL
limma_coxboost=NULL
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=readRDS("savedresults/melanomanano_bw_cox1t.rds")
tcox3=readRDS("savedresults/melanomanano_bw_cox2t.rds")
tcox4=readRDS("savedresults/melanomanano_bw_cox3t.rds")
tpcox1=readRDS("savedresults/melanomanano_p_cox1t.rds")
tpcox2=readRDS("savedresults/melanomanano_p_cox2t.rds")
tpcox3=readRDS("savedresults/melanomanano_p_cox3t.rds")
trsf1=readRDS("savedresults/melanomanano_rsf1t.rds")
trsf2=readRDS("savedresults/melanomanano_rsf2t.rds")
tmtlr1=readRDS("savedresults/melanomanano_mtlrt.rds")
tdnnsurv1=readRDS("savedresults/melanomanano_dnnsurvt.rds")
tcoxboost=readRDS("savedresults/melanomanano_coxboostt.rds")

tsurvivalsvm=NULL
tga_cox=NULL
tga_mtlr=NULL
tga_coxboost=NULL
tlimma_mtlr=NULL
tlimma_coxboost=NULL
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)
m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g17=plot_fun1(m)
g18=plot_fun2(t)
melanomananoall=cbind.data.frame(m,t,m1,t1)
melanomananoall$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#gse1
cox1=NULL
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/gse1_p_cox1m.rds")
pcox2=readRDS("savedresults/gse1_p_cox2m.rds")
pcox3=readRDS("savedresults/gse1_p_cox3m.rds")
rsf1=readRDS("savedresults/gse1_rsf1m.rds")
rsf2=readRDS("savedresults/gse1_rsf2m.rds")
mtlr1=NULL
dnnsurv1=NULL
coxboost=readRDS("savedresults/gse1_coxboostm.rds")
ga_cox=readRDS("savedresults/gse1_ga_cox1m.rds")
ga_mtlr=readRDS("savedresults/gse1_ga_mtlrm.rds")
ga_coxboost=readRDS("savedresults/gse1_ga_coxboostm.rds")
limma_mtlr=readRDS("savedresults/gse1_limma_mtlrm.rds")
limma_coxboost=readRDS("savedresults/gse1_limma_coxboostm.rds")
survivalsvm=readRDS("savedresults/gse1_survivalsvmm.rds")
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/gse1_p_cox1t.rds")*60
tpcox2=readRDS("savedresults/gse1_p_cox2t.rds")*60
tpcox3=readRDS("savedresults/gse1_p_cox3t.rds")*60
trsf1=readRDS("savedresults/gse1_rsf1t.rds")*60
trsf2=readRDS("savedresults/gse1_rsf2t.rds")*60
tmtlr1=NULL
tdnnsurv1=NULL
tcoxboost=readRDS("savedresults/gse1_coxboostt.rds")*60
tga_cox=readRDS("savedresults/gse1_ga_cox1t.rds")*60
tga_mtlr=readRDS("savedresults/gse1_ga_mtlrt.rds")*60
tga_coxboost=readRDS("savedresults/gse1_ga_coxboostt.rds")*60
tlimma_mtlr=readRDS("savedresults/gse1_limma_mtlrt.rds")*60
tlimma_coxboost=readRDS("savedresults/gse1_limma_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/gse1_survivalsvmt.rds")
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)
m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g19=plot_fun1(m)
g20=plot_fun2(t)
gse1all=cbind.data.frame(m,t,m1,t1)
gse1all$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#gse2
cox1=NULL
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/gse4_p_cox1m.rds")
pcox2=readRDS("savedresults/gse4_p_cox2m.rds")
pcox3=readRDS("savedresults/gse4_p_cox3m.rds")
rsf1=readRDS("savedresults/gse4_rsf1m.rds")
rsf2=readRDS("savedresults/gse4_rsf2m.rds")
mtlr1=NULL
dnnsurv1=NULL
coxboost=readRDS("savedresults/gse4_coxboostm.rds")
ga_cox=readRDS("savedresults/gse4_ga_cox1m.rds")
ga_mtlr=readRDS("savedresults/gse4_ga_mtlrm.rds")
ga_coxboost=readRDS("savedresults/gse4_ga_coxboostm.rds")
limma_mtlr=readRDS("savedresults/gse4_limma_mtlrm.rds")
limma_coxboost=readRDS("savedresults/gse4_limma_coxboostm.rds")
survivalsvm=readRDS("savedresults/gse4_survivalsvmm.rds")
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/gse4_p_cox1t.rds")*60
tpcox2=readRDS("savedresults/gse4_p_cox2t.rds")*60
tpcox3=readRDS("savedresults/gse4_p_cox3t.rds")*60
trsf1=readRDS("savedresults/gse4_rsf1t.rds")*60
trsf2=readRDS("savedresults/gse4_rsf2t.rds")*60
tmtlr1=NULL
tdnnsurv1=NULL
tcoxboost=readRDS("savedresults/gse4_coxboostt.rds")
tga_cox=readRDS("savedresults/gse4_ga_cox1t.rds")*60
tga_mtlr=readRDS("savedresults/gse4_ga_mtlrt.rds")*60
tga_coxboost=readRDS("savedresults/gse4_ga_coxboostt.rds")*60
tlimma_mtlr=readRDS("savedresults/gse4_limma_mtlrt.rds")*60
tlimma_coxboost=readRDS("savedresults/gse4_limma_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/gse4_survivalsvmt.rds")
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)
m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g21=plot_fun1(m)
g22=plot_fun2(t)
gse2all=cbind.data.frame(m,t,m1,t1)
gse2all$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#ngene1
cox1=NULL
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/ngse1_p_cox1m.rds")
pcox2=readRDS("savedresults/ngse1_p_cox2m.rds")
pcox3=readRDS("savedresults/ngse1_p_cox3m.rds")
rsf1=readRDS("savedresults/ngse1_rsf1m.rds")
rsf2=readRDS("savedresults/ngse1_rsf2m.rds")
mtlr1=readRDS("savedresults/ngse1_mtlrm.rds")
dnnsurv1=readRDS("savedresults/ngse1_dnnsurvm.rds")
coxboost=readRDS("savedresults/ngse1_coxboostm.rds")
ga_cox=readRDS("savedresults/ngse1_ga_cox1m.rds")
ga_mtlr=readRDS("savedresults/ngse1_ga_mtlrm.rds")
ga_coxboost=readRDS("savedresults/ngse1_ga_coxboostm.rds")
limma_mtlr=readRDS("savedresults/ngse1_limma_mtlrm.rds")
limma_coxboost=readRDS("savedresults/ngse1_limma_coxboostm.rds")
survivalsvm=readRDS("savedresults/ngse1_survivalsvmm.rds")
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/ngse1_p_cox1t.rds")
tpcox2=readRDS("savedresults/ngse1_p_cox2t.rds")
tpcox3=readRDS("savedresults/ngse1_p_cox3t.rds")
trsf1=readRDS("savedresults/ngse1_rsf1t.rds")
trsf2=readRDS("savedresults/ngse1_rsf2t.rds")
tmtlr1=readRDS("savedresults/ngse1_mtlrt.rds")*60
tdnnsurv1=readRDS("savedresults/ngse1_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/ngse1_coxboostt.rds")
tga_cox=readRDS("savedresults/ngse1_ga_cox1t.rds")*60
tga_mtlr=readRDS("savedresults/ngse1_ga_mtlrt.rds")*60
tga_coxboost=readRDS("savedresults/ngse1_ga_coxboostt.rds")*60
tlimma_mtlr=readRDS("savedresults/ngse1_limma_mtlrt.rds")
tlimma_coxboost=readRDS("savedresults/ngse1_limma_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/ngse1_survivalsvmt.rds")
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g23=plot_fun1(m)
g24=plot_fun2(t)
ngene1all=cbind.data.frame(m,t,m1,t1)
ngene1all$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#ngene2
cox1=NULL
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/ngse2_p_cox1m.rds")
pcox2=readRDS("savedresults/ngse2_p_cox2m.rds")
pcox3=readRDS("savedresults/ngse2_p_cox3m.rds")
rsf1=readRDS("savedresults/ngse2_rsf1m.rds")
rsf2=readRDS("savedresults/ngse2_rsf2m.rds")
mtlr1=readRDS("savedresults/ngse2_mtlrm.rds")
dnnsurv1=readRDS("savedresults/ngse2_dnnsurvm.rds")
coxboost=readRDS("savedresults/ngse2_coxboostm.rds")
ga_cox=readRDS("savedresults/ngse2_ga_cox1m.rds")
ga_mtlr=readRDS("savedresults/ngse2_ga_mtlrm.rds")
ga_coxboost=readRDS("savedresults/ngse2_ga_coxboostm.rds")
limma_mtlr=readRDS("savedresults/ngse2_limma_mtlrm.rds")
limma_coxboost=readRDS("savedresults/ngse2_limma_coxboostm.rds")
survivalsvm=readRDS("savedresults/ngse2_survivalsvmm.rds")
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/ngse2_p_cox1t.rds")*60
tpcox2=readRDS("savedresults/ngse2_p_cox2t.rds")*60
tpcox3=readRDS("savedresults/ngse2_p_cox3t.rds")*60
trsf1=readRDS("savedresults/ngse2_rsf1t.rds")*60
trsf2=readRDS("savedresults/ngse2_rsf2t.rds")*60
tmtlr1=readRDS("savedresults/ngse2_mtlrt.rds")*3600
tdnnsurv1=readRDS("savedresults/ngse2_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/ngse2_coxboostt.rds")
tga_cox=readRDS("savedresults/ngse2_ga_cox1t.rds")*60
tga_mtlr=readRDS("savedresults/ngse2_ga_mtlrt.rds")*60
tga_coxboost=readRDS("savedresults/ngse2_ga_coxboostt.rds")*60
tlimma_mtlr=readRDS("savedresults/ngse2_limma_mtlrt.rds")
tlimma_coxboost=readRDS("savedresults/ngse2_limma_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/ngse2_survivalsvmt.rds")*60
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g25=plot_fun1(m)
g26=plot_fun2(t)
ngene2all=cbind.data.frame(m,t,m1,t1)
ngene2all$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#ngene3
cox1=NULL
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/ngse3_p_cox1m.rds")
pcox2=readRDS("savedresults/ngse3_p_cox2m.rds")
pcox3=readRDS("savedresults/ngse3_p_cox3m.rds")
rsf1=readRDS("savedresults/ngse3_rsf1m.rds")
rsf2=readRDS("savedresults/ngse3_rsf2m.rds")
mtlr1=readRDS("savedresults/ngse3_mtlrm.rds")
dnnsurv1=readRDS("savedresults/ngse3_dnnsurvm.rds")
coxboost=readRDS("savedresults/ngse3_coxboostm.rds")
ga_cox=readRDS("savedresults/ngse3_ga_cox1m.rds")
ga_mtlr=readRDS("savedresults/ngse3_ga_mtlrm.rds")
ga_coxboost=readRDS("savedresults/ngse3_ga_coxboostm.rds")
limma_mtlr=readRDS("savedresults/ngse3_limma_mtlrm.rds")
limma_coxboost=readRDS("savedresults/ngse3_limma_coxboostm.rds")
survivalsvm=NULL
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/ngse3_p_cox1t.rds")
tpcox2=readRDS("savedresults/ngse3_p_cox2t.rds")*60
tpcox3=readRDS("savedresults/ngse3_p_cox3t.rds")
trsf1=readRDS("savedresults/ngse3_rsf1t.rds")*60
trsf2=readRDS("savedresults/ngse3_rsf2t.rds")*60
tmtlr1=readRDS("savedresults/ngse3_mtlrt.rds")*3600
tdnnsurv1=readRDS("savedresults/ngse3_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/ngse3_coxboostt.rds")
tga_cox=readRDS("savedresults/ngse3_ga_cox1t.rds")*60
tga_mtlr=readRDS("savedresults/ngse3_ga_mtlrt.rds")*60
tga_coxboost=readRDS("savedresults/ngse3_ga_coxboostt.rds")*60
tlimma_mtlr=readRDS("savedresults/ngse3_limma_mtlrt.rds")
tlimma_coxboost=readRDS("savedresults/ngse3_limma_coxboostt.rds")
tsurvivalsvm=NULL
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g27=plot_fun1(m)
g28=plot_fun2(t)
ngene3all=cbind.data.frame(m,t,m1,t1)
ngene3all$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#ngene4
cox1=NULL
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/ngse4_p_cox1m.rds")
pcox2=readRDS("savedresults/ngse4_p_cox2m.rds")
pcox3=readRDS("savedresults/ngse4_p_cox3m.rds")
rsf1=readRDS("savedresults/ngse4_rsf1m.rds")
rsf2=readRDS("savedresults/ngse4_rsf2m.rds")
mtlr1=readRDS("savedresults/ngse4_mtlrm.rds")
dnnsurv1=readRDS("savedresults/ngse4_dnnsurvm.rds")
coxboost=readRDS("savedresults/ngse4_coxboostm.rds")
ga_cox=readRDS("savedresults/ngse4_ga_cox1m.rds")
ga_mtlr=readRDS("savedresults/ngse4_ga_mtlrm.rds")
ga_coxboost=readRDS("savedresults/ngse4_ga_coxboostm.rds")
limma_mtlr=readRDS("savedresults/ngse4_limma_mtlrm.rds")
limma_coxboost=readRDS("savedresults/ngse4_limma_coxboostm.rds")
survivalsvm=readRDS("savedresults/ngse4_survivalsvmm.rds")
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/ngse4_p_cox1t.rds")
tpcox2=readRDS("savedresults/ngse4_p_cox2t.rds")
tpcox3=readRDS("savedresults/ngse4_p_cox3t.rds")
trsf1=readRDS("savedresults/ngse4_rsf1t.rds")*60
trsf2=readRDS("savedresults/ngse4_rsf2t.rds")*60
tmtlr1=readRDS("savedresults/ngse4_mtlrt.rds")*3600
tdnnsurv1=readRDS("savedresults/ngse4_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/ngse4_coxboostt.rds")
tga_cox=readRDS("savedresults/ngse4_ga_cox1t.rds")*60
tga_mtlr=readRDS("savedresults/ngse4_ga_mtlrt.rds")*60
tga_coxboost=readRDS("savedresults/ngse4_ga_coxboostt.rds")*60
tlimma_mtlr=readRDS("savedresults/ngse4_limma_mtlrt.rds")
tlimma_coxboost=readRDS("savedresults/ngse4_limma_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/ngse4_survivalsvmt.rds")
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g29=plot_fun1(m)
g30=plot_fun2(t)
ngene4all=cbind.data.frame(m,t,m1,t1)
ngene4all$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#ngene5
cox1=NULL
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/ngse5_p_cox1m.rds")
pcox2=readRDS("savedresults/ngse5_p_cox2m.rds")
pcox3=readRDS("savedresults/ngse5_p_cox3m.rds")
rsf1=readRDS("savedresults/ngse5_rsf1m.rds")
rsf2=readRDS("savedresults/ngse5_rsf2m.rds")
mtlr1=readRDS("savedresults/ngse5_mtlrm.rds")
dnnsurv1=readRDS("savedresults/ngse5_dnnsurvm.rds")
coxboost=readRDS("savedresults/ngse5_coxboostm.rds")
ga_cox=readRDS("savedresults/ngse5_ga_cox1m.rds")
ga_mtlr=readRDS("savedresults/ngse5_ga_mtlrm.rds")
ga_coxboost=readRDS("savedresults/ngse5_ga_coxboostm.rds")
limma_mtlr=readRDS("savedresults/ngse5_limma_mtlrm.rds")
limma_coxboost=readRDS("savedresults/ngse5_limma_coxboostm.rds")
survivalsvm=readRDS("savedresults/ngse5_survivalsvmm.rds")
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/ngse5_p_cox1t.rds")
tpcox2=readRDS("savedresults/ngse5_p_cox2t.rds")
tpcox3=readRDS("savedresults/ngse5_p_cox3t.rds")
trsf1=readRDS("savedresults/ngse5_rsf1t.rds")*60
trsf2=readRDS("savedresults/ngse5_rsf2t.rds")*60
tmtlr1=readRDS("savedresults/ngse5_mtlrt.rds")*60
tdnnsurv1=readRDS("savedresults/ngse5_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/ngse5_coxboostt.rds")
tga_cox=readRDS("savedresults/ngse5_ga_cox1t.rds")*60
tga_mtlr=readRDS("savedresults/ngse5_ga_mtlrt.rds")*60
tga_coxboost=readRDS("savedresults/ngse5_ga_coxboostt.rds")*60
tlimma_mtlr=readRDS("savedresults/ngse5_limma_mtlrt.rds")
tlimma_coxboost=readRDS("savedresults/ngse5_limma_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/ngse5_survivalsvmt.rds")
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g31=plot_fun1(m)
g32=plot_fun2(t)
ngene5all=cbind.data.frame(m,t,m1,t1)
ngene5all$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
#ngene6
cox1=NULL
cox2=NULL
cox3=NULL
cox4=NULL
pcox1=readRDS("savedresults/ngse6_p_cox1m.rds")
pcox2=readRDS("savedresults/ngse6_p_cox2m.rds")
pcox3=readRDS("savedresults/ngse6_p_cox3m.rds")
rsf1=readRDS("savedresults/ngse6_rsf1m.rds")
rsf2=readRDS("savedresults/ngse6_rsf2m.rds")
mtlr1=readRDS("savedresults/ngse6_mtlrm.rds")
dnnsurv1=readRDS("savedresults/ngse6_dnnsurvm.rds")
coxboost=readRDS("savedresults/ngse6_coxboostm.rds")
ga_cox=readRDS("savedresults/ngse6_ga_cox1m.rds")
ga_mtlr=readRDS("savedresults/ngse6_ga_mtlrm.rds")
ga_coxboost=readRDS("savedresults/ngse6_ga_coxboostm.rds")
limma_mtlr=readRDS("savedresults/ngse6_limma_mtlrm.rds")
limma_coxboost=readRDS("savedresults/ngse6_limma_coxboostm.rds")
survivalsvm=readRDS("savedresults/ngse6_survivalsvmm.rds")
model_list1=list(cox1,cox2,cox3,cox4,pcox1,pcox2,pcox3,rsf1,rsf2,mtlr1,dnnsurv1,coxboost,ga_cox,ga_mtlr,ga_coxboost,limma_mtlr,limma_coxboost,survivalsvm)
tcox1=NULL
tcox2=NULL
tcox3=NULL
tcox4=NULL
tpcox1=readRDS("savedresults/ngse6_p_cox1t.rds")*60
tpcox2=readRDS("savedresults/ngse6_p_cox2t.rds")*60
tpcox3=readRDS("savedresults/ngse6_p_cox3t.rds")*60
trsf1=readRDS("savedresults/ngse6_rsf1t.rds")*60
trsf2=readRDS("savedresults/ngse6_rsf2t.rds")*60
tmtlr1=readRDS("savedresults/ngse6_mtlrt.rds")*3600
tdnnsurv1=readRDS("savedresults/ngse6_dnnsurvt.rds")*60
tcoxboost=readRDS("savedresults/ngse6_coxboostt.rds")
tga_cox=readRDS("savedresults/ngse6_ga_cox1t.rds")*60
tga_mtlr=readRDS("savedresults/ngse6_ga_mtlrt.rds")*60
tga_coxboost=readRDS("savedresults/ngse6_ga_coxboostt.rds")
tlimma_mtlr=readRDS("savedresults/ngse6_limma_mtlrt.rds")
tlimma_coxboost=readRDS("savedresults/ngse6_limma_coxboostt.rds")
tsurvivalsvm=readRDS("savedresults/ngse6_survivalsvmt.rds")*60
model_list2=list(tcox1,tcox2,tcox3,tcox4,tpcox1,tpcox2,tpcox3,trsf1,trsf2,tmtlr1,tdnnsurv1,tcoxboost,tga_cox,tga_mtlr,tga_coxboost,tlimma_mtlr,tlimma_coxboost,tsurvivalsvm)

m=memory_fun(model_list1)
t=time_fun(model_list2)
m1=as.vector(ifelse(m>10,"large",ifelse(m<5,"small","medium")))
t1=as.vector(ifelse(t<100,"fast",ifelse(t>1000,"slow","ok")))
g33=plot_fun1(m)
g34=plot_fun2(t)
ngene6all=cbind.data.frame(m,t,m1,t1)
ngene6all$methods=c("cox1","cox2","cox3","cox4","pcox1","pcox2","pcox3","rsf1","rsf2","mtlr1","dnnsurv1","coxboost","gacox","gamtlr","gacoxboost","limmamtlr","limmacoxboost","survivalsvm")
```



```{r}
labelss<-c("pbc","veteran","lung","anz","us","melanoma_clinical","melanoma_itraq","melanoma_swath","melanoma_nano","gse1","gse2","ngene1","ngene2","ngene3","ngene4","ngene5","ngene6")
ggarrange(g1,g3,g5,g7,g9,g11,g13,g15,g17,g19,g21,g23,g25,g27,g29,g31,g33,labels = labelss,ncol = 3, nrow = 6)

ggarrange(g2,g4,g6,g8,g10,g12,g14,g16,g18,g20,g22,g24,g24,g26,g28,g30,g32,g34,labels = labelss,ncol = 3, nrow = 6)

```


# all summary
```{r}
data_list2=list(pbcall,veteranall,lungall,anzall,usall,melanomaclinicalall,melanomaitraqall,melanomaswathall,melanomananoall,gse1all,gse2all,ngene1all,ngene2all,ngene3all,ngene4all,ngene5all,ngene6all)
datafull2=bind_rows(data_list2, .id = "datasets")
datafull2$datasets=mapvalues(datafull2$datasets, from = seq(1,17,1), to = c("pbc","veteran","lung","anz","us","melanomaclinical","melanomaitraq","melanomaswath","melanomanano","gse1","gse2","ngene1","ngene2","mgene3","ngene4","ngene5","ngene6"))
timememorydt=datafull2%>% group_by(methods) %>%dplyr::summarize(Mean_time = mean(t, na.rm=TRUE),Mean_memory=mean(m,na.rm = TRUE))

datafull3=datafull
datafull3$datasets=mapvalues(datafull3$datasets, from = seq(1,17,1), to = c("anz","us","veteran","lung","pbc","melanoma_clinical","melanomaitraq","melanomaswath","melanomanano","gse1","gse2","ngene1","ngene2","mgene3","ngene4","ngene5","ngene6"))
predictiondt=datafull3%>% group_by(model,variable) %>%dplyr::summarize(Mean_value = mean(value, na.rm=TRUE), SD_value=sd(value,na.rm = TRUE))
predictiondt2=predictiondt[predictiondt$variable %in% c("hc", "unoc", "bs1","auc1", "auc5", "auc10", "auc15", "auc"),]
predictiondt3 <- tidyr::spread(predictiondt2[,1:3], variable, Mean_value)
predictiondt4=tidyr::spread(predictiondt2[,c(1,2,4)], variable, SD_value)


allsummarydt=cbind.data.frame(timememorydt,predictiondt3[,2:9],predictiondt4[,2:9])

colnames(allsummarydt)=c("methods","Mean_time","Mean_memory","Mean_hc","Mean_unoc","Mean_bs","Mean_auc1","Mean_auc5","Mean_auc10","Mean_auc15","Mean_iauc","SD_hc","SD_unoc","SD_bs","SD_auc1","SD_auc5","SD_auc10","SD_auc15","SD_iauc")

allsummarydt2=select(allsummarydt, -methods) %>% mutate_all(funs(dense_rank(desc(.))))
allsummarydt3=select(allsummarydt, -methods) %>% mutate_all(funs(rank(.)))
allsummarydt4=cbind.data.frame(allsummarydt2[,3:10],allsummarydt3[,c(1,2,11:18)])
rownames(allsummarydt4)=allsummarydt$methods


nb.cols <- 18
mycolors <- colorRampPalette(brewer.pal(8, "PuOr"))(nb.cols)

mat=as.matrix(allsummarydt4)
Heatmap(t(mat), name = "rank", col = mycolors,cluster_rows = FALSE,cluster_columns=TRUE,rect_gp = gpar(col = "white", lwd = 2))

```



```{r}
indicator=read_excel("result.xlsx",sheet = 11)
pheatmap(indicator[,-1],cluster_cols = FALSE, cluster_rows = FALSE)
```








